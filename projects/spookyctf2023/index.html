<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Sp00kyCTF 2023 | Trent R. Walraven</title> <meta name="author" content="Trent R. Walraven"> <meta name="description" content="Putting on the third annual Sp00kyCTF by IASG at Iowa State University"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/icons/favicon.ico"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://walraven.dev/projects/spookyctf2023/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Trent </span>R. Walraven</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">GitHub Overview</a> </li> <li class="nav-item "> <a class="nav-link" href="/resume/">Resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Sp00kyCTF 2023</h1> <p class="post-description">Putting on the third annual Sp00kyCTF by IASG at Iowa State University</p> </header> <article> <p>This year was the third annual SpookyCTF put on by the Information Assurance Student Group here at Iowa State University. This CTF is designed to be an introduction to Capture The Flag competitions as whole, to allow students here at Iowa State have an way to learn more and take part in a CTF with having minimal or no knowledge, and have fun while doing it. Part of how we make it beginner friendly is by having the cabinet create challenges for the competition, we were in the same seats as the participants not that long ago, and gives us a good perspective on what we would know in their shoes.</p> <p>Now that the competition is couple weeks behind me, I’m taking some time to reflect on how the competition went. On the immediate day of the competition, I thought it went extremely, with no major issues happening, and good participation. What made me more proud, was both during and after competition, participating students talked about how they enjoyed the competition, and how they felt like they learned things by competing. This alone makes the whole event a success to me, younger students getting helped into that baseline knowledge level to be able to compete on their own in CTFs in the future, and having fun while doing it.</p> <p>The participants were not the people learning from the event though, I also learned a lot from this event as well. Something that was new this year was that we had sponsors for the event and not purely club funded. As the club really has not done large amounts of fundraising, getting donations from corporations was a new experience for me. I decided to reach out to RSM about sponsoring prizes, as their funding would allow our club to provide better overall prizes for the participants. After reaching out to a contact that I had there, they were more than happy to help, and provided the prizes for the first place team.</p> <p>We also were reached out to by SecDSM, a local cyber security group, about helping with the event when they heard that we were putting it on. They wanted to also help with prize and food support, which was amazing! They provided the second place prizes, along with lunch for all the participants. What was more unexpected is that I also mentioned that if there was anyone looking to create some challenges for the event, that we would be interested in having them help out there too.</p> <p>To my surprise, there was someone that was interested in helping out with making challenges. This person was a long time veteran CTF player, and also helped create a number of CTFs before. This was a wonderful learning experience for me to have someone experienced helping with the competition, as he firstly in just a couple days filled out many of the beginner level challenges that we knew we wanted to make, but had not completed yet, along with adding many of his own. The part that I learned the most from, was how to weight and balance challenges, points, and hints, so that the competition was fair and fun. While we had been trying to balance these already, that was one of the struggles from competition last year with challenges not being weighted correctly. Having him guide me on how to score challenges well against each other, so that one category, or challenges made by one person were worth more than others, was a great learning experience for me.</p> <p>For the competition, I also had the chance to write a total of 17 challenges. I had written a few small challenges before, but this year I set out to write some hardware based challenges, since that often feels under represented in CTFs, and hardware security is a passion of mine. Of the 17 challenges that I ended up writing 4 hardware based challenges total, all of which turned out very well and covered a very broad range of difficulty. My favorite of the challenges has to be a challenge called <em>RGB Madness</em> which gave the users a capture from a logic analyzer that was taken while capturing the output of a micro-controller powering an array of LEDs. With the default view showing just a few points, but as you zoomed in there was a lot more noticeable detail about each of the locations with peaks.</p> <p><img src="/assets/images/projects/spookyctf2023/rgb-madness-wide.png" alt="Wide View of the Logic Analyzer Capture"> The wide view of the logic analyzer capture, that shows a few areas with peaks, but not major detail.</p> <p><img src="/assets/images/projects/spookyctf2023/rgb-madness-close.png" alt="Zoomed in View of the Logic Analyzer Capture"> Zooming in on one of the peaks to show how each sections has clear detail about what is happening on the wire.</p> <p>There some information that this was using a common RGB LED based on everything that was known. In this case, this signalling is using the protocol for the WS2812B LED, which is a common LED used in many projects. The protocol is a relatively simple one with a “packet” containing 3 bytes * number of LEDs, where each byte represents the R, G, and B values specifically. And each bit of the packet either being represented by a “long” pulse where 2/3 of the pulse time is high representing a 1, and a “short” pulse where 1/3 of the pulse is high representing a 0, then constant low when no data transmission is happening. Being this simple there were a variety of ways to decode it, either with a program or by hand. The challenge used either white or off for LEDs, so the 3 byte values in each packet were either all 0s or all 1s, which made it easy to see the difference between a 0 and 1. This could then be decoded by hand with a sliding scale the length of a packet and reading if the LED was on or off at each point. It could have also been automated in a variety of ways like using a decoder built into a logic analyzer.</p> <p><img src="/assets/images/projects/spookyctf2023/rgb-madness-leds.png" alt="The letter 'S' in blue on a grid of neopixels"> Image showing the letter ‘S’ would appear on the LEDs in on online micro-controller simulator. In this case I used blue, since it showed up better in this online simulator.</p> <p>This challenge was a lot of fun to make as it helped me build my skills in using a logic analyzer to capture data from real hardware, along with working with micro-controller modeling tools like <a href="https://wokwi.com/" target="_blank" rel="external nofollow noopener">Wokwi</a> where I built an basic testing LED array, so that I could test my code without having to utilize real hardware. <a href="https://wokwi.com/projects/383951138537721857" target="_blank" rel="external nofollow noopener">Wokwi Testing Environment</a>.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Trent R. Walraven. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?28b72e58db9fa38993ca8c23d6f45dc0"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>